@startuml C4_Components
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

Container(Frontend, "Frontend", "JavaScript/React", "Single Page Application die de gebruikersinterface levert")

' Backend Componenten
System_Boundary(Backend, "TripTop Backend") {
    Component(BookingController, "BookingController", "Spring Boot REST Controller", "Behandelt boekingsaanvragen")
    Component(BookingService, "BookingService", "Service Layer", "Verwerkt boekingslogica")
    Component(BookingRepository, "BookingRepository", "Spring Data Repository", "Leest/schrijft boekingsdata in database")
    Component(UserController, "UserController", "Spring Boot REST Controller", "Behandelt gebruikersaanvragen")
    Component(UserService, "UserService", "Service Layer", "Verwerkt gebruikerslogica")
    Component(UserRepository, "UserRepository", "Spring Data Repository", "Leest/schrijft gebruikersdata in database")
    Component(TravelDataController, "TravelDataController", "Spring Boot REST Controller", "Behandelt reisdata en activiteiten")
    Component(TravelDataService, "TravelDataService", "Service Layer", "Verwerkt reisdata en activiteiten")
    Component(TravelDataRepository, "TravelDataRepository", "Spring Data Repository", "Leest/schrijft reisdata in database")

    Component(PaymentController, "PaymentController", "Service Layer", "Verwerkt betaallogica")
    Component(PaymentService, "PaymentService", "Service Layer", "Verwerkt betaallogica")
    Component(BetaalFacade, "BetaalFacade", "interface", "Interactie met betaalservice")

    Component(PaypalFacade, "PaypalFacade", "Facade", "Interactie met PayPal service")
    Component(InvoiceFacade, "InvoiceFacade", "Facade", "Interactie met factuurservice")

    Component(PaypalService, "PaypalService", "Service", "Afhandelen van PayPal-betalingen")
    Component(InvoiceService, "InvoiceService", "Service", "Afhandelen van factuurbetalingen")

    Component(iAuthProviderAdapter, "iAuthProviderAdapter", "Service Layer", "Verzorgt authenticatie via externe providers")
    Component(iBookingProviderAdapter, "iBookingProviderAdapter", "Service Layer", "Verzorgt boekingen via externe systemen")
    ComponentDb(Database, "TripTop Database", "Couchbase", "Bewaart gebruikers- en reisgegevens")
}

' Externe systemen
System_Ext(BookingAPI, "Booking.com / Airbnb API", "Beheert accommodatieboekingen")
System_Ext(TransportAPI, "NS / Deutsche Bahn / KLM API", "Biedt transportopties")
System_Ext(CarRentAPI, "Sixt / Hertz API", "Auto verhuurdiensten")
System_Ext(ActivitiesAPI, "Tripadvisor / GetYourGuide API", "Biedt activiteiten en ervaringen")
System_Ext(FoodAPI, "Takeaway / Eet.nu API", "Eten bezorgen en restaurantboekingen")
System_Ext(GoogleAuthAPI, "Google Login API", "Authenticatie via Google")
System_Ext(MicrosoftAuthAPI, "Microsoft Login API", "Authenticatie via Microsoft")
System_Ext(PaypalApi, "PayPal", "Verwerkt PayPal betalingen")

' Relaties
BookingController -down-> BookingService : "Verwerkt boeking aanvragen"
BookingService -down-> BookingRepository : "Ophalen en opslaan van boekingsdata"
BookingRepository -down-> Database : "Leest/schrijft boekingsdata"
UserService -down-> UserRepository : "Ophalen en opslaan van gebruikersdata"
TravelDataController -down-> TravelDataService : "Verwerkt reisdata en activiteiten"
TravelDataService -down-> TravelDataRepository : "Ophalen en opslaan van reisdata"
TravelDataRepository -down-> Database : "Leest/schrijft reisdata"

iAuthProviderAdapter -right-> GoogleAuthAPI : "Authenticatie via Google"
iAuthProviderAdapter -right-> MicrosoftAuthAPI : "Authenticatie via Microsoft"

iBookingProviderAdapter -left-> BookingAPI : "Boekt accommodaties"
iBookingProviderAdapter -left-> TransportAPI : "Boekt transport"
iBookingProviderAdapter -left-> CarRentAPI : "Boekt huurauto"
iBookingProviderAdapter -left-> ActivitiesAPI : "Boekt activiteiten"
iBookingProviderAdapter -left-> FoodAPI : "Regelt restaurantboekingen"

BookingService -left-> iBookingProviderAdapter : "Communiceert met externe systemen voor boekingen"
BookingRepository -[hidden]-> "TravelDataService"

Frontend -down-> BookingController : "Boekingen beheren [HTTP/JSON]"
Frontend -down-> UserController : "Gebruikersbeheer en authenticatie [HTTP/JSON]"
Frontend -down-> TravelDataController : "Boekingen beheren [HTTP/JSON]"
UserController -down-> UserService : "Verwerkt gebruikers aanvragen"
UserRepository -down-> Database : "Leest/schrijft gebruikersdata"
UserService -right-> iAuthProviderAdapter : "Regelt authenticatie via externe providers"

Frontend --> PaymentController : "Roept aan"
PaymentController --> PaymentService : "Maakt gebruik van"
PaymentService --> BetaalFacade : "Stuurt verzoeken naar"
BetaalFacade <.. PaypalFacade : "Implementeert"
BetaalFacade <.. InvoiceFacade : "Implementeert"
PaypalFacade --> PaypalService : "Stuurt verzoeken naar"
InvoiceFacade --> InvoiceService : "Stuurt verzoeken naar"
PaypalService --> PaypalApi : "Vraagt betaling aan"

@enduml
